-----------------
loading CUDA 12.4
-----------------

/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/generic.py:311: FutureWarning: `torch.utils._pytree._register_pytree_node` is deprecated. Please use `torch.utils._pytree.register_pytree_node` instead.
  torch.utils._pytree._register_pytree_node(
Traceback (most recent call last):
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1282, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/generation/utils.py", line 84, in <module>
    from accelerate.hooks import AlignDevicesHook, add_hook_to_module
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/accelerate/__init__.py", line 16, in <module>
    from .accelerator import Accelerator
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/accelerate/accelerator.py", line 34, in <module>
    from huggingface_hub import split_torch_state_dict_into_shards
ImportError: cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/huggingface_hub/__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1282, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/modeling_utils.py", line 39, in <module>
    from .generation import GenerationConfig, GenerationMixin
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1272, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1284, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.generation.utils because of the following error (look up to see its traceback):
cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/huggingface_hub/__init__.py)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/runpy.py", line 187, in _run_module_as_main
    mod_name, mod_spec, code = _get_module_details(mod_name, _Error)
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/runpy.py", line 110, in _get_module_details
    __import__(pkg_name)
  File "/work/asdf1234/cobra_new/cobra/__init__.py", line 1, in <module>
    from .models import available_model_names, available_models, get_model_description, load
  File "/work/asdf1234/cobra_new/cobra/models/__init__.py", line 1, in <module>
    from .load import available_model_names, available_models, get_model_description, load
  File "/work/asdf1234/cobra_new/cobra/models/load.py", line 19, in <module>
    from cobra.models.materialize import get_llm_backbone_and_tokenizer, get_vision_backbone_and_transform
  File "/work/asdf1234/cobra_new/cobra/models/materialize.py", line 11, in <module>
    from cobra.models.backbones.llm import LLMBackbone, MambaLLMBackbone
  File "/work/asdf1234/cobra_new/cobra/models/backbones/llm/__init__.py", line 1, in <module>
    from .base_llm import LLMBackbone
  File "/work/asdf1234/cobra_new/cobra/models/backbones/llm/base_llm.py", line 22, in <module>
    from transformers import AutoConfig, AutoTokenizer, PreTrainedModel, PreTrainedTokenizerBase
  File "<frozen importlib._bootstrap>", line 1075, in _handle_fromlist
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1272, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 1284, in _get_module
    raise RuntimeError(
RuntimeError: Failed to import transformers.modeling_utils because of the following error (look up to see its traceback):
Failed to import transformers.generation.utils because of the following error (look up to see its traceback):
cannot import name 'split_torch_state_dict_into_shards' from 'huggingface_hub' (/work/asdf1234/miniconda3/envs/cobra/lib/python3.10/site-packages/huggingface_hub/__init__.py)
